{% comment %} 
      This section is used in the list-collections template to render a list of 
      collections and products. 
      https://shopify.dev/docs/storefronts/themes/architecture/templates/collection
{% endcomment %}

{% comment %} Hide collections section to focus on products {% endcomment %}

{% comment %} Show all products from all collections {% endcomment %}
<div class="all-products-section">
  <h1>Our Products</h1>
  <div class="products-grid">
    {% for product in collections.all.products limit: 24 %}
      <div class="product-card">
        <a href="{{ product.url }}" class="product-link">
          <div class="product-image">
            {% if product.featured_image %}
              <img
                src="{{ product.featured_image | image_url: width: 300 }}"
                alt="{{ product.title }}"
                class="product-img"
                width="300"
                height="300">
            {% else %}
              <div class="product-placeholder">
                <svg
                  width="60"
                  height="60"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg">
                  <rect
                    x="3"
                    y="3"
                    width="18"
                    height="18"
                    rx="2"
                    stroke="#24BAAD"
                    stroke-width="2" />
                  <path
                    d="M9 9h6v6H9z"
                    stroke="#24BAAD"
                    stroke-width="2" />
                </svg>
              </div>
            {% endif %}
            {% if product.compare_at_price > product.price %}
              <div class="product-badge">Sale</div>
            {% endif %}
            {% if product.available == false %}
              <div class="product-sold-out-badge">Sold Out</div>
            {% endif %}
          </div>
          <div class="product-info">
            {% comment %} Category pill - prefer product.type, fallback to known tags or first tag {% endcomment %}
            {% assign category_text = product.type | default: '' %}
            {% if category_text == blank and product.tags.size > 0 %}
              {% assign found = '' %}
              {% for t in product.tags %}
                {% assign tl = t | downcase %}
                {% if tl contains 'ayur' or tl contains 'herbal' or tl contains 'organic' or tl contains 'supplement' %}
                  {% assign found = t %}
                  {% break %}
                {% endif %}
              {% endfor %}
              {% if found != '' %}
                {% assign category_text = found %}
              {% else %}
                {% assign category_text = product.tags.first %}
              {% endif %}
            {% endif %}

            {% if category_text != blank %}
              <div class="card__category">
                <span class="card__category-tag">{{ category_text }}</span>
              </div>
            {% endif %}

            <h3 class="product-title">{{ product.title }}</h3>
            <div class="product-price">
              {% if product.compare_at_price > product.price %}
                <span class="price-compare">₹{{ product.compare_at_price | money_without_currency }}</span>
                <span class="price-current">₹{{ product.price | money_without_currency }}</span>
              {% else %}
                <span class="price-current">₹{{ product.price | money_without_currency }}</span>
              {% endif %}
            </div>
          </div>
        </a>
      </div>
    {% endfor %}
  </div>

  {% if collections.all.products.size > 24 %}
    <div class="view-all-products">
      <a href="{{ routes.all_products_collection_url }}" class="view-all-btn">View All Products</a>
    </div>
  {% endif %}
</div>

{% stylesheet %}
  .collections-section {
    margin-bottom: 60px;
  }

  .collections-section h2 {
    font-size: 24px;
    font-weight: 600;
    color: #333;
    margin-bottom: 24px;
    text-align: center;
  }

  .collections {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(min(var(--collection-card-size), 100%), 1fr));
    gap: var(--grid-gap);
    margin-bottom: 40px;
  }
  .collections--compact {
    --collection-card-size: 160px;
  }
  .collections--full {
    --collection-card-size: 280px;
  }
  .collection-card {
    display: flex;
    flex-direction: column;
    width: 100%;
    background: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    transition: all 0.3s ease;
    text-decoration: none;
    color: inherit;
  }

  .collection-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 30px rgba(36, 186, 173, 0.15);
  }

  .collection-card__content {
    padding: 20px;
  }

  .collection-card__content p:first-child {
    font-size: 18px;
    font-weight: 600;
    color: #333;
    margin-bottom: 8px;
  }

  .collection-count {
    font-size: 14px;
    color: #24BAAD;
    font-weight: 500;
    margin-bottom: 8px;
  }

  .collection-card__content p:last-child {
    font-size: 14px;
    color: #666;
    line-height: 1.4;
  }

  .all-products-section h1 {
    font-size: 36px;
    font-weight: 700;
    color: #333;
    margin-bottom: 40px;
    text-align: center;
    font-family: 'Inter'
    , sans-serif;
  }

  .products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 30px;
    margin-bottom: 40px;
  }

  .product-card {
    background: white;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    transition: all 0.3s ease;
    border: 1px solid #f0f0f0;
  }

  .product-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 40px rgba(36, 186, 173, 0.15);
    border-color: #24BAAD;
  }

  .product-link {
    text-decoration: none;
    color: inherit;
    display: block;
  }

  .product-image {
    position: relative;
    width: 100%;
    height: 200px;
    overflow: hidden;
    background: #f8f9fa;
  }

  .product-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .product-card:hover .product-img {
    transform: scale(1.05);
  }

  .product-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f0fdfc;
  }

  .product-badge {
    position: absolute;
    top: 12px;
    left: 12px;
    background: #ff4757;
    color: white;
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
  }

  .product-sold-out-badge {
    position: absolute;
    top: 12px;
    right: 12px;
    background: #666;
    color: white;
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
  }

  .product-info {
    padding: 20px;
  }

  .product-title {
    font-size: 16px;
    font-weight: 600;
    color: #333;
    margin-bottom: 12px;
    line-height: 1.4;
    font-family: 'Inter'
    , sans-serif;
  }

  .product-price {
    margin-bottom: 12px;
  }

  .price-current {
    font-size: 18px;
    font-weight: 700;
    color: #24BAAD;
  }

  .price-compare {
    font-size: 14px;
    color: #999;
    text-decoration: line-through;
    margin-right: 8px;
  }

  .view-all-products {
    text-align: center;
    margin-top: 40px;
  }

  .view-all-btn {
    display: inline-flex;
    align-items: center;
    background: #24BAAD;
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .view-all-btn:hover {
    background: #1ea89a;
    transform: translateY(-2px);
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .products-grid {
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }

    .collections {
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
  }

  @media (max-width: 480px) {
    .products-grid {
      grid-template-columns: 1fr;
    }

    .collections {
      grid-template-columns: 1fr;
    }
  }
{% endstylesheet %}

{% schema %}
  {
    "name": "t:general.collections_grid",
    "settings": [
      {
        "type": "select",
        "id": "grid_item_width",
        "label": "t:labels.grid_item_width",
        "options": [
          {
            "value": "collections--compact",
            "label": "t:options.size.small"
          }, {
            "value": "collections--full",
            "label": "t:options.size.large"
          }
        ],
        "default": "collections--full"
      }, {
        "type": "range",
        "id": "grid_gap",
        "label": "t:labels.grid_gap",
        "min": 0,
        "max": 50,
        "step": 5,
        "unit": "px",
        "default": 10
      }
    ],
    "presets": [
      {
        "name": "t:general.collections_grid"
      }
    ]
  }
{% endschema %}